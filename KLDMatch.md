# KLDを用いた特徴点選定によるマッチング高速化

## 背景
- パノラマ画像は72枚の写真を横方向に結合した非常に横長な画像である。  
- ユーザーが撮影した画像との特徴点マッチングでは、処理対象となる特徴点数が多く、計算コストが大きい。  
- 全ての特徴点を使用する必要はなく、マッチングに寄与しない特徴点を除外すれば処理を高速化できる。

## 提案手法の概要
- **KLD（Kullback–Leibler Divergence：カルバック・ライブラー情報量）**を利用して、  
  パノラマ画像中の特徴点分布の違いを定量的に評価する。  
- フレーム間で分布の差が小さい（＝情報量が少ない）特徴点を除去することで、  
  冗長な特徴を削減し、マッチング処理の高速化を実現する。

## 手順
1. パノラマ画像をフレーム単位に分割（例：72フレーム）。
2. 各フレーム内の特徴点分布を確率分布 \( P_a(x) \) として表現する。
3. 隣接フレーム間でKLDを計算する：  
   \[
   D_{KL}(P_a || P_b) = \sum_x P_a(x) \log \frac{P_a(x)}{P_b(x)}
   \]
4. 隣接3フレーム（\( a-1, a, a+1 \)）のKLDを比較し、  
   差分が小さい領域の特徴点を除去する。
5. 残った「変化の大きい＝特徴的な」領域の特徴点を  
   ユーザー画像とのマッチングに使用する。

## 特徴
- 類似パターンや繰り返し構造を持つ領域を自動的にスキップ可能。  
- 特徴点数の削減によりマッチング計算の時間を短縮。  
- 事前にパノラマ全域の特徴的領域を抽出することで、リアルタイムな照合が容易。

## 想定効果
- **処理速度の向上**（特徴点数削減に比例）  
- **無駄なマッチングの抑制**  
- **類似風景・繰り返し模様に強い画像照合性能**

---

**キーワード:**  
パノラマ画像, 特徴点選定, KLD, 画像マッチング, 高速化
